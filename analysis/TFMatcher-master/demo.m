%sim = imread('sim.png');
%imshow(sim);
%roipoly;
%real = imread('real.jpg');
%imshow(real);
%roipoly;

figure;
%% WOODWARD
woodward_sim = [168.15099009901 320.766089108911;168.831683168317 343.909653465347;274.339108910891 418.105198019802;276.381188118812 436.483910891089;287.95297029703 429.67698019802;316.542079207921 449.417079207921;317.903465346535 439.887376237624;339.685643564356 440.568069306931;339.685643564356 418.785891089109;351.257425742574 418.785891089109;351.257425742574 407.214108910891;339.685643564356 407.214108910891;339.685643564356 385.431930693069;328.113861386138 386.112623762376;328.113861386138 353.439356435644;341.04702970297 353.439356435644;341.04702970297 342.548267326733;351.938118811881 342.548267326733;351.257425742574 320.085396039604;373.720297029703 320.085396039604;373.720297029703 275.159653465347;361.467821782178 275.159653465347;361.467821782178 264.268564356436;350.576732673267 264.268564356436;350.576732673267 252.016089108911;328.794554455445 252.016089108911;328.794554455445 243.167079207921;295.440594059406 243.167079207921;295.440594059406 198.241336633663;309.735148514851 198.241336633663;309.735148514851 177.139851485149;264.128712871287 177.139851485149;264.128712871287 192.795792079208;251.195544554455 192.795792079208;251.195544554455 215.258663366337;231.455445544554 215.258663366337;232.136138613861 234.318069306931;219.883663366337 234.318069306931;220.564356435643 269.714108910891;198.782178217822 270.394801980198;198.782178217822 258.142326732673;187.891089108911 258.142326732673;187.891089108911 290.134900990099;177 290.134900990099;177 322.808168316832];
woodward_real = [2067.20602125148 2981.01948051948;2934.26623376623 3720.57083825266;2940.64167650531 3848.07969303424;3036.2733175915 3797.07615112161;3412.42443919717 4071.22018890201;3635.56493506494 3899.08323494687;3731.19657615112 3650.44096812279;3641.94037780401 3554.8093270366;3520.80696576151 3522.9321133412;3514.43152302243 3408.17414403778;3603.68772136954 3267.91440377804;3731.19657615112 3229.66174734357;3712.07024793388 3006.5212514758;3590.93683589138 2987.39492325856;3571.81050767414 2840.75974025974;3724.82113341204 2808.88252656435;3705.69480519481 2566.61570247934;3584.5613931523 2528.36304604486;3603.68772136954 2375.35242030697;3482.55430932704 2490.11038961039;3425.17532467532 2413.60507674144;2934.26623376623 2164.96280991736;3080.90141676505 2145.83648170012;3157.406729634 1897.19421487603;3010.77154663518 1839.81523022432;3023.52243211334 1699.55548996458;2953.39256198347 1565.67119244392;2915.139905549 1731.43270365998;2857.76092089728 1693.1800472255;2851.38547815821 1565.67119244392;2743.00295159386 1686.80460448642;2640.99586776859 1980.07497048406;2685.62396694215 2069.33116883117;2794.00649350649 2075.70661157025;2749.37839433294 2215.96635182999;2583.61688311688 2126.71015348288;2436.98170011806 2419.98051948052;2475.23435655254 2572.99114521842;2360.47638724911 2579.3665879575;2373.22727272727 2681.37367178276;2449.73258559622 2668.62278630461;2487.9852420307 2808.88252656435;2309.47284533648 2923.64049586777;2232.96753246753 2859.88606847698;2175.58854781582 2949.14226682409];
Analyze(woodward_sim, woodward_real, 42, 10, 30);
title('Woodward Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(30, '--b');
xline(10, '--b');

%% LAKE
figure;
lake_sim = [282.619951040392 357.642594859241;353.974908200734 356.171358629131;353.974908200734 373.090575275398;285.562423500612 373.826193390453;289.976132190942 440.03182374541;301.010403916769 439.296205630355;301.746022031824 448.123623011016;309.83782129743 448.123623011016;310.573439412485 465.778457772338;320.136474908201 465.042839657283;320.136474908201 475.341493268054;329.699510403917 474.605875152999;329.699510403917 483.43329253366;456.961444308445 481.96205630355;455.490208078335 456.215422276622;472.409424724602 456.215422276622;471.673806609547 467.249694002448;480.501223990208 465.778457772338;479.029987760098 448.123623011016;495.949204406365 448.123623011016;495.949204406365 439.296205630355;520.960220318237 438.5605875153;520.960220318237 429.733170134639;529.052019583843 430.468788249694;523.902692778458 344.40146878825;540.086291309669 344.40146878825;540.821909424724 353.964504283966;557.005507955936 353.228886168911;556.269889840881 362.056303549572;565.832925336597 361.320685434517;565.097307221542 371.619339045288;574.660342717258 369.412484700122;573.924724602203 344.40146878825;584.958996328029 344.40146878825;584.223378212974 362.056303549572;592.31517747858 362.056303549572;592.31517747858 371.619339045288;601.878212974296 370.883720930233;601.142594859241 334.838433292534;609.970012239902 334.838433292534;609.234394124847 326.011015911873;627.624847001224 326.746634026928;628.360465116279 336.309669522644;637.923500611995 335.574051407589;636.452264381885 264.954712362301;645.279681762546 265.690330477356;644.544063647491 248.035495716034;654.107099143207 248.771113831089;653.371481028152 239.208078335373;671.761933904529 239.208078335373;670.290697674418 206.105263157895;681.324969400245 205.36964504284;680.58935128519 195.070991432069;661.463280293758 196.542227662179;662.198898408813 188.450428396573;636.452264381885 188.450428396573;636.452264381885 178.887392900857;617.326193390453 178.887392900857;618.797429620563 189.186046511628;610.705630354957 188.450428396573;610.705630354957 206.84088127295;601.142594859241 206.84088127295;602.613831089351 232.587515299878;593.050795593635 231.851897184823;593.78641370869 248.771113831089;570.246634026927 249.506731946144;568.775397796818 214.932680538556;579.809669522644 214.932680538556;579.074051407589 179.623011015912;453.28335373317 179.623011015912;453.28335373317 189.921664626683;434.157282741738 189.186046511628;435.628518971848 197.277845777234;426.801101591187 196.542227662179;429.007955936352 205.36964504284;410.617503059975 205.36964504284;415.766829865361 268.632802937577;406.9394124847 267.897184822521;407.675030599755 278.195838433293;330.435128518972 278.195838433293;330.435128518972 287.758873929009;312.044675642595 286.287637698898;313.515911872705 295.850673194615;303.952876376989 295.115055079559;306.159730722154 303.94247246022;288.504895960832 303.206854345165;289.240514075887 313.505507955936;280.413096695226 312.769889840881];
lake_real = [3788.57556080283 4205.10448642267;3865.08087367178 4147.72550177096;3852.32998819362 4256.1080283353;4247.60743801653 4211.47992916175;4381.49173553719 4134.9746162928;4381.49173553719 4045.71841794569;4636.50944510035 3924.58500590319;4591.8813459268 3835.32880755608;4623.7585596222 3752.44805194805;4764.01829988194 3714.19539551358;4827.77272727273 3765.19893742621;4859.64994096812 3879.95690672963;5012.66056670602 3790.70070838253;4974.40791027155 3637.69008264463;5146.54486422668 3573.93565525384;5216.67473435655 2910.88961038961;5299.55548996458 2764.25442739079;5376.06080283353 2655.87190082645;5420.68890200708 2694.12455726092;5484.44332939787 2630.37012987013;5427.06434474616 2598.49291617474;5516.32054309327 2521.98760330579;5694.83293978749 2541.11393152302;5656.58028335301 2349.85064935065;5752.2119244392 2292.47166469894;5643.82939787485 2082.08205430933;5701.20838252656 2056.58028335301;5580.07497048406 1941.82231404959;5694.83293978749 1897.19421487603;5886.09622195986 1635.80106257379;5898.84710743802 1533.79397874852;5777.71369539551 1540.1694214876;5713.95926800472 1629.42561983471;5656.58028335301 1591.17296340024;5541.82231404959 1763.30991735537;5376.06080283353 1686.80460448642;5388.81168831169 1610.29929161747;5197.54840613931 1616.67473435655;5267.67827626919 1699.55548996458;5070.03955135773 1718.68181818182;4910.65348288075 1635.80106257379;5101.91676505313 1629.42561983471;5420.68890200708 1361.65702479339;5484.44332939787 1023.7585596222;5388.81168831169 877.123376623377;5388.81168831169 1081.13754427391;5318.68181818182 1138.51652892562;5203.92384887839 1055.63577331759;5184.79752066116 1202.27095631641;5025.41145218418 1202.27095631641;5172.046635183 991.881345926801;5248.55194805195 660.358323494688;5178.42207792208 634.856552538372;5044.53778040142 845.246162927982;4974.40791027155 896.249704840615;4999.90968122786 1100.26387249115;4891.52715466352 1138.51652892562;4917.02892561983 1215.02184179457;4802.27095631641 1297.9025974026;4840.52361275089 1412.66056670602;4617.38311688312 1470.03955135773;4515.37603305785 1457.28866587958;4273.10920897284 1584.79752066116;4202.97933884298 1807.93801652893;4209.35478158205 1986.45041322314;3992.58972845336 2031.0785123967;3686.56847697757 2254.21900826446;3431.5507674144 2521.98760330579;3374.17178276269 2483.73494687131;3170.15761511216 2509.23671782763;3131.90495867769 2598.49291617474;3157.406729634 2917.26505312869;3259.41381345927 3057.52479338843;3080.90141676505 3369.92148760331;3029.89787485242 3312.54250295159;2940.64167650531 3414.54958677686;2940.64167650531 3535.68299881936;2889.63813459268 3580.31109799292;2959.76800472255 3669.56729634002;3042.64876033058 3580.31109799292;3112.77863046045 3714.19539551358;3291.29102715466 3682.31818181818;3348.67001180637 3746.07260920897;3329.54368358914 3848.07969303424;3476.17886658796 3911.83412042503;3488.92975206612 4064.84474616293;3648.31582054309 4147.72550177096;3731.19657615112 4077.59563164109];
Analyze(lake_sim, lake_real, 85, 11, 60);
title('Lake Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(11, '--b');
xline(60, '--b');
%% MOC
figure;
moc_sim = [374.307833537332 246.564259485924;392.698286413709 264.219094247246;388.284577723378 316.447980416157;369.158506731946 317.183598531212;367.687270501836 334.838433292534;386.813341493268 334.838433292534;384.606487148103 373.090575275398;402.99694002448 373.090575275398;402.99694002448 391.481028151775;422.123011015912 411.342717258262;441.249082007344 390.74541003672;441.984700122399 371.619339045288;478.765605875153 371.619339045288;479.501223990208 391.481028151775;497.891676866585 390.74541003672;497.15605875153 408.400244798042;535.408200734394 408.400244798042;534.672582619339 426.790697674419;552.327417380661 426.055079559364;553.063035495716 407.664626682987;571.453488372093 406.929008567932;569.246634026928 369.412484700122;606.763157894737 369.412484700122;605.291921664627 387.802937576499;625.889228886169 388.538555691555;625.153610771114 407.664626682987;682.53182374541 409.871481028152;683.267441860465 391.481028151775;663.405752753978 390.74541003672;663.405752753978 353.228886168911;684.00305997552 353.964504283966;683.267441860465 334.102815177479;663.405752753978 334.838433292534;662.670134638923 297.321909424725;642.808445532436 298.793145654835;643.544063647491 279.667074663403;587.637086903305 281.138310893513;586.90146878825 262.012239902081;608.234394124847 243.621787025704;588.37270501836 225.966952264382;570.717870257038 226.702570379437;570.717870257038 206.84088127295;551.591799265606 207.576499388005;552.327417380661 228.173806609547;533.936964504284 227.438188494492;534.672582619339 248.771113831089;516.282129742962 246.564259485924;517.753365973072 263.483476132191;464.788861689107 262.747858017136;465.524479804162 245.828641370869;411.824357405141 245.828641370869;413.295593635251 227.438188494492;392.698286413709 228.173806609547];
moc_real = [3096.5 2486.37320574163;3313.14593301435 2686.35406698565;3385.36124401914 2703.01913875598;3402.02631578947 2630.8038277512;3518.68181818182 2669.68899521531;3557.56698564593 2608.58373205742;3624.22727272727 2641.91387559809;3640.89234449761 2603.02870813397;3763.1028708134 2658.57894736842;3857.53827751196 2641.91387559809;4024.18899521531 2497.48325358852;3901.97846889952 2358.60765550239;3907.53349282297 2319.72248803828;4063.07416267943 2347.4976076555;4074.18421052632 2225.28708133971;4157.50956937799 2164.18181818182;4163.06459330144 2080.85645933014;4090.84928229665 2030.86124401914;4018.63397129187 2030.86124401914;3996.41387559809 1964.2009569378;3935.30861244019 1903.0956937799;3851.98325358852 1908.65071770335;3818.65311004785 1830.88038277512;3746.43779904306 1825.32535885167;3696.44258373206 1891.98564593301;3502.01674641148 1558.68421052631;3296.48086124402 1430.91866028708;3190.93540669857 1297.5980861244;3090.94497607656 1230.93779904306;3013.17464114833 1253.15789473684;2985.3995215311 1308.70813397129;2840.96889952153 1319.81818181818;2785.41866028708 1247.6028708134;2696.53827751196 1247.6028708134;2602.1028708134 1419.80861244019;2318.7966507177 1325.37320574163;2313.24162679426 1519.7990430622;2374.34688995215 1692.00478468899;2429.8971291866 1747.55502392344;2402.12200956938 1808.66028708134;2302.13157894737 1814.21531100478;2091.04066985646 1714.22488038277;2129.92583732058 1825.32535885167;2024.38038277512 1953.09090909091;2213.25119617225 2175.29186602871;2357.68181818182 2197.51196172249;2413.23205741627 2347.4976076555;2324.35167464115 2475.26315789474;2368.79186602871 2580.80861244019;2385.45693779904 2719.68421052631;2507.66746411483 2808.56459330143;2713.2033492823 2697.46411483254;2907.62918660287 2703.01913875598];
Analyze(moc_sim, moc_real, 50, 10, 44);
title('MOC Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(44, '--b');
xline(10, '--b');
%% Fox
figure;
fox_sim = [495.815756823821 424.982009925558;505.772332506203 424.982009925558;505.772332506203 415.025434243176;515.728908188586 415.689205955335;515.728908188586 395.776054590571;525.021712158809 395.776054590571;524.35794044665 386.483250620347;542.943548387097 386.483250620347;542.279776674938 374.535359801489;552.23635235732 374.535359801489;552.23635235732 365.242555831266;542.279776674938 365.242555831266;542.279776674938 347.984491315137;552.23635235732 347.984491315137;561.529156327543 337.364143920596;550.908808933002 328.735111662531;550.908808933002 310.813275434243;568.83064516129 310.813275434243;568.83064516129 275.633374689826;578.123449131514 275.633374689826;578.123449131514 249.746277915633;559.537841191067 249.746277915633;559.537841191067 231.160669975186;568.83064516129 231.160669975186;569.494416873449 221.867866004963;559.537841191067 221.867866004963;560.201612903226 203.282258064516;523.694168734491 203.946029776675;524.35794044665 177.395161290323;515.065136476427 177.395161290323;515.065136476427 193.989454094293;469.928660049628 186.024193548387;451.343052109181 186.024193548387;451.343052109181 195.980769230769;461.299627791563 195.980769230769;469.264888337469 201.954714640199;468.60111662531 221.204094292804;458.644540942928 221.204094292804;459.308312655087 266.340570719603;450.679280397022 266.340570719603;450.679280397022 302.848014888338;459.308312655087 302.848014888338;459.308312655087 312.140818858561;467.937344913151 312.140818858561;467.937344913151 341.346774193548;477.230148883375 341.346774193548;477.230148883375 358.604838709677;468.60111662531 358.604838709677;468.60111662531 367.233870967742;457.980769230769 367.233870967742;458.644540942928 397.103598014888;467.937344913151 397.103598014888;467.937344913151 407.06017369727;486.522952853598 407.06017369727;486.522952853598 417.680521091811;496.47952853598 416.352977667494];
fox_real = [2776.1242568371 2549.07312722949;2874.22175980975 2560.84482758621;2874.22175980975 2521.60582639715;2917.38466111772 2494.1385255648;2940.92806183115 2505.91022592152;2893.84126040428 2572.61652794293;2909.5368608799 2631.47502972652;2940.92806183115 2662.86623067776;2933.08026159334 2725.64863258026;2937.00416171225 2788.43103448276;2980.16706302021 2859.06123662307;3023.32996432818 2831.59393579073;3050.79726516052 2796.27883472057;3074.34066587396 2776.65933412604;3066.49286563615 2733.49643281807;2999.78656361474 2686.4096313912;3015.48216409037 2651.09453032105;3066.49286563615 2592.23602853746;3019.40606420927 2470.59512485137;3074.34066587396 2309.71521997622;3117.50356718193 2243.00891795482;3137.12306777646 2144.91141498216;3121.42746730083 1948.71640903686;3141.04696789536 1882.01010701546;3133.19916765755 1823.15160523187;3105.73186682521 1827.07550535077;3078.26456599287 1878.08620689655;3070.41676575505 1728.97800237812;3101.8079667063 1638.72829964328;3046.87336504162 1575.94589774078;2988.01486325803 1568.09809750297;2913.46076099881 1560.25029726516;2917.38466111772 1611.26099881094;2885.99346016647 1630.88049940547;2889.91736028537 1677.96730083234;2858.52615933413 1650.5;2780.048156956 1658.34780023781;2725.11355529132 1650.5;2717.26575505351 1607.33709869203;2646.6355529132 1638.72829964328;2689.79845422116 1677.96730083234;2634.86385255648 1709.35850178359;2705.49405469679 1732.90190249703;2756.50475624257 1764.29310344828;2776.1242568371 1846.6950059453;2740.80915576694 1862.39060642093;2713.3418549346 1799.60820451843;2713.3418549346 1760.36920332937;2658.40725326992 1768.21700356718;2607.39655172414 1779.9887039239;2576.00535077289 1850.61890606421;2595.62485136742 1929.09690844233;2658.40725326992 1944.79250891796;2650.5594530321 2015.42271105826;2623.09215219976 2093.90071343639;2619.16825208086 2164.53091557669];
Analyze(fox_sim, fox_real, 53, 13, 45);
title('Fox Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(45, '--b');
xline(13, '--b');
%% Valley
figure;
valley_sim = [333.067251461988 101.005847953216;304.552631578947 132;334.30701754386 161.754385964912;335.546783625731 191.508771929825;364.061403508772 191.508771929825;364.681286549708 251.637426900585;393.815789473684 250.397660818714;393.195906432749 281.391812865497;420.470760233918 281.391812865497;420.470760233918 311.766081871345;511.593567251462 309.906432748538;512.213450292398 339.040935672515;481.83918128655 367.555555555556;570.482456140351 366.315789473684;570.482456140351 396.690058479532;600.236842105263 396.690058479532;600.236842105263 425.204678362573;660.985380116959 428.304093567252;660.985380116959 398.549707602339;722.353801169591 399.789473684211;722.353801169591 368.795321637427;782.482456140351 370.035087719298;786.201754385965 311.766081871345;722.353801169591 310.526315789474;723.593567251462 248.538011695907;691.359649122807 279.53216374269;659.125730994152 278.912280701754;659.745614035088 220.023391812866;540.728070175439 219.40350877193;541.347953216374 130.760233918129;511.593567251462 130.760233918129;512.213450292398 72.4912280701755;482.459064327486 72.4912280701755;482.459064327486 42.7368421052632;424.190058479532 45.8362573099416;424.190058479532 102.245614035088];
valley_real = [3215.86385542169 1530.6265060241;3123.54337349398 1325.46987951807;2925.22530120482 1171.60240963855;2720.0686746988 1192.11807228916;2521.75060240964 1062.18554216867;2343.94819277108 1062.18554216867;2299.49759036145 1007.47710843373;2258.46626506024 1027.99277108434;2285.82048192771 1116.89397590361;2193.5 1130.57108433735;2053.30963855422 1260.50361445783;2261.88554216867 1325.46987951807;2333.69036144578 1551.1421686747;2439.68795180723 1585.33493975904;2545.68554216867 1540.8843373494;2566.20120481928 1465.66024096386;2617.49036144578 1547.72289156626;2723.48795180723 1554.56144578313;2795.29277108434 1670.81686746988;2873.93614457831 1749.46024096386;2870.51686746988 1824.6843373494;2983.35301204819 1971.71325301205;3140.63975903614 2016.16385542169;3137.22048192771 2053.77590361446;3421.02048192771 2180.28915662651;3482.56746987952 2125.58072289157;3650.11204819277 2139.2578313253;3766.36746987952 2091.38795180723;3821.07590361446 1971.71325301205;3899.71927710843 2060.61445783133;3985.20120481928 1930.68192771084;4125.39156626506 1951.19759036145;4002.29759036145 1773.39518072289;3831.33373493976 1616.10843373494;3646.69277108434 1489.59518072289;3417.60120481928 1489.59518072289];
Analyze(valley_sim, valley_real, 33, 5, 29);
title('Valley Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(29, '--b');
xline(5, '--b');
%% Poodle
figure;
poodle_sim = [265.869298245614 363.336842105263;267.107894736842 393.682456140351;545.172807017544 391.824561403509;543.934210526316 360.240350877193;604.625438596491 359.621052631579;604.625438596491 300.168421052632;573.041228070175 300.168421052632;573.660526315789 209.131578947368;634.351754385965 209.750877192982;634.351754385965 115.617543859649;605.864035087719 115.617543859649;605.864035087719 147.201754385965;544.55350877193 147.201754385965;513.588596491228 116.856140350877;483.24298245614 147.201754385965;451.658771929825 145.963157894737;451.658771929825 208.512280701754;421.313157894737 209.131578947368;422.551754385965 269.822807017544;390.348245614035 269.822807017544;390.967543859649 300.787719298246;327.799122807018 300.168421052632;327.799122807018 363.336842105263];
poodle_real = [549.432384341637 3706.01601423488;1825.94483985765 3712.06583629893;2098.18683274021 3464.0231316726;2043.7384341637 2980.03736654804;2303.88078291815 2477.90213523132;2570.07295373666 2671.49644128114;2775.76690391459 2205.66014234875;3048.00889679715 2084.66370106762;2884.66370106762 1915.26868327402;2116.33629893239 2060.46441281139;2152.63523131673 1836.62099644128;2061.88790035587 1025.94483985765;1723.09786476868 1249.78825622776;1735.1975088968 1461.53202846975;1940.89145907473 1685.37544483986;1904.59252669039 2145.16192170818;1462.95551601424 2290.35765124555;1106.01601423488 2604.94839857651;1003.16903914591 2907.43950177936;827.724199288256 3052.63523131673;434.485765124556 3101.03380782918;180.393238434163 3373.27580071174;646.229537366548 3385.37544483986];
Analyze(poodle_sim, poodle_real, 20, 5, 18);
title('Poodle Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(18, '--b');
xline(5, '--b');
%% Twin
figure;
twin_sim = [491.926799007444 408.485111662531;565.74317617866 401.169975186104;565.74317617866 391.859801488834;575.053349875931 391.859801488834;575.053349875931 373.904466501241;583.698511166253 364.59429280397;574.388337468983 355.949131513648;574.388337468983 320.038461538461;583.698511166253 320.038461538461;583.698511166253 301.418114143921;574.388337468983 301.418114143921;575.053349875931 274.817617866005;583.698511166253 266.172456575682;573.723325062035 257.52729528536;566.408188585608 257.52729528536;566.408188585608 248.882133995037;557.098014888338 248.882133995037;557.098014888338 230.926799007444;565.74317617866 230.926799007444;565.078163771712 221.616625310174;575.053349875931 221.616625310174;575.053349875931 195.681141439206;566.408188585608 195.681141439206;566.408188585608 169.08064516129;556.43300248139 169.08064516129;557.098014888338 151.125310173697;512.542183622829 150.460297766749;502.56699751861 158.440446650124;511.877171215881 166.420595533499;511.877171215881 185.04094292804;493.921836228288 185.04094292804;493.921836228288 195.016129032258;483.946650124069 195.016129032258;483.946650124069 203.661290322581;458.011166253102 203.661290322581;449.366004962779 195.016129032258;429.415632754342 212.971464019851;439.390818858561 222.281637717121;439.390818858561 230.926799007444;449.366004962779 230.926799007444;448.700992555831 239.571960297767;456.681141439206 239.571960297767;457.346153846154 257.52729528536;448.700992555831 257.52729528536;448.700992555831 266.172456575682;438.725806451613 266.172456575682;438.725806451613 278.142679900744;420.105459057072 276.147642679901;410.795285359801 286.122828784119;420.105459057072 294.102977667494;420.77047146402 311.393300248139;402.150124069479 311.393300248139;392.17493796526 322.698511166253;402.815136476427 330.678660049628;420.105459057072 330.678660049628;420.105459057072 341.983870967742;428.750620347394 341.983870967742;428.085607940447 351.95905707196;446.705955334987 351.95905707196;455.35111662531 363.264267990074;463.996277915633 351.95905707196;474.636476426799 351.95905707196;474.636476426799 361.934243176179;481.951612903226 361.934243176179;481.951612903226 372.574441687345;492.591811414392 372.574441687345];
twin_real = [1481.10498220641 1593.11565836299;1505.30427046263 1659.66370106762;1529.50355871886 1662.68861209964;1550.67793594306 1708.06227758007;1559.75266903915 1674.78825622776;1599.07651245552 1711.0871886121;1620.25088967972 1698.98754448399;1635.37544483986 1720.16192170819;1656.54982206406 1717.13701067616;1638.40035587189 1653.61387900356;1623.27580071174 1629.41459074733;1635.37544483986 1611.26512455516;1674.69928825623 1638.48932384342;1683.77402135231 1623.36476868327;1656.54982206406 1581.01601423488;1692.8487544484 1593.11565836299;1692.8487544484 1553.79181494662;1680.74911032029 1532.61743772242;1695.87366548043 1511.44306049822;1729.14768683274 1535.64234875445;1735.1975088968 1487.24377224199;1720.07295373666 1456.99466192171;1738.22241992883 1447.91992882562;1747.29715302491 1423.7206405694;1732.17259786477 1375.32206405694;1759.39679715302 1354.14768683274;1768.47153024911 1254.3256227758;1747.29715302491 1239.20106761566;1768.47153024911 1148.4537366548;1786.62099644128 1133.32918149466;1744.27224199288 1087.95551601424;1680.74911032029 1090.98042704626;1698.89857651246 1054.68149466192;1641.42526690391 1045.60676156584;1608.1512455516 1121.22953736655;1577.90213523132 1121.22953736655;1544.628113879 1145.42882562278;1496.22953736655 1163.57829181495;1490.17971530249 1118.20462633452;1496.22953736655 1075.85587188612;1478.08007117438 1042.58185053381;1469.00533807829 1000.23309608541;1426.65658362989 991.158362989324;1399.43238434164 1018.38256227758;1405.48220640569 1051.65658362989;1393.38256227758 1069.80604982206;1393.38256227758 1100.05516014235;1381.28291814947 1124.25444839858;1399.43238434164 1199.87722419929;1378.25800711744 1236.17615658363;1335.90925266904 1202.90213523132;1272.38612099644 1211.9768683274;1260.28647686833 1245.25088967972;1290.53558718861 1242.22597864769;1317.75978647687 1260.37544483986;1369.18327402135 1281.54982206406;1320.7846975089 1308.77402135231;1293.56049822064 1332.97330960854;1284.48576512455 1387.42170818505;1287.51067615658 1429.77046263345;1317.75978647687 1447.91992882562;1305.66014234875 1493.29359430605;1290.53558718861 1502.36832740214;1332.88434163701 1556.81672597865;1369.18327402135 1544.71708185053;1390.35765124555 1584.0409252669];
Analyze(twin_sim, twin_real, 63, 13, 52);
title('Twin Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(13, '--b');
xline(52, '--b');

%% Stewart Canyon
steward_sim = [430.08064516129 442.400744416873;444.710918114144 427.77047146402;458.67617866005 442.400744416873;472.641439205955 428.435483870968;485.941687344913 429.100496277916;485.941687344913 443.065756823821;526.507444168735 443.065756823821;526.507444168735 387.204714640198;512.542183622829 387.204714640198;512.542183622829 357.944168734491;526.507444168735 357.944168734491;526.507444168735 343.978908188585;540.47270471464 343.978908188585;540.47270471464 303.413151364764;580.373449131514 303.413151364764;580.373449131514 290.112903225806;594.338709677419 290.112903225806;594.338709677419 276.812655086849;608.303970223325 276.812655086849;608.303970223325 262.847394540943;622.934243176179 262.847394540943;622.934243176179 249.547146401985;634.904466501241 249.547146401985;634.904466501241 154.450372208437;580.373449131514 154.450372208437;580.373449131514 196.346153846154;538.477667493797 196.346153846154;538.477667493797 224.276674937965;511.212158808933 224.276674937965;511.212158808933 236.911910669975;445.375930521092 236.911910669975;445.375930521092 250.212158808933;432.740694789082 249.547146401985;432.740694789082 262.182382133995;419.440446650124 262.182382133995;420.105459057072 277.477667493796;406.140198511166 277.477667493796;406.140198511166 290.777915632754;392.17493796526 290.777915632754;391.509925558313 331.343672456576;352.274193548387 330.678660049628;338.973945409429 343.978908188585;352.939205955335 357.944168734491;365.574441687345 357.279156327543;363.579404466501 387.204714640198;376.214640198511 386.539702233251;375.549627791563 401.834987593052;388.184863523573 401.834987593052;388.184863523573 417.130272952853;418.110421836228 416.465260545906;416.780397022332 431.760545905707];
steward_real = [1447.83096085409 4044.80604982206;1804.77046263345 4038.75622775801;2191.9590747331 3881.46085409253;2246.40747330961 3518.47153024911;2167.75978647687 3336.9768683274;1925.76690391459 3252.2793594306;1732.17259786477 3312.77758007117;1647.47508896797 3451.92348754448;1738.22241992883 3107.08362989324;1514.37900355872 2852.99110320285;1599.07651245552 2804.59252669039;1756.371886121 2852.99110320285;2022.5640569395 2822.74199288256;2101.21174377224 2483.95195729537;2222.20818505338 2465.8024911032;2306.90569395018 2241.9590747331;2458.1512455516 2350.85587188612;2573.09786476868 2151.21174377224;2657.79537366548 2169.36120996441;2748.54270462634 2072.5640569395;2857.43950177936 2120.96263345196;2893.7384341637 1788.22241992883;2603.34697508897 1267.93772241993;2597.29715302491 1086.44306049822;2343.20462633452 1086.44306049822;2161.70996441281 1231.63879003559;2367.40391459075 1467.58185053381;2306.90569395018 1515.98042704626;2179.85943060498 1449.43238434164;2070.96263345196 1594.628113879;2222.20818505338 1897.11921708185;1901.56761565836 1824.52135231317;1792.67081850534 1939.46797153025;1635.37544483986 1927.36832740213;1514.37900355872 1963.66725978648;1320.7846975089 2163.31138790036;1163.48932384342 2362.95551601423;981.994661921708 2302.45729537367;860.99822064057 2532.35053380783;945.695729537367 2665.44661921708;1163.48932384342 2713.84519572954;1169.53914590747 2804.59252669039;988.044483985765 2810.64234875445;1000.14412811388 2967.93772241993;1127.19039145907 2986.0871886121;1332.88434163701 3161.53202846975;1187.68861209964 3203.88078291815;1054.59252669039 3306.72775800712;945.695729537367 3572.91992882562;927.546263345196 3905.66014234875;1248.18683274021 3905.66014234875];
figure;
Analyze(steward_sim, steward_real, 48, 17, 47);
title('Stewart Canyon Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(17, '--b');
xline(47, '--b');

%% Slater
slater_sim = [396.263027295285 158.068858560794;396.929280397022 208.704094292804;445.565756823821 208.037841191067;446.232009925558 258.00682382134;472.882133995037 258.00682382134;472.882133995037 281.325682382134;509.526054590571 281.991935483871;509.526054590571 341.954714640198;522.184863523573 341.954714640198;522.184863523573 377.932382133995;509.526054590571 377.932382133995;509.526054590571 403.25;522.184863523573 403.25;522.184863523573 415.908808933002;545.503722084367 415.908808933002;545.503722084367 427.901364764268;557.496277915633 427.901364764268;557.496277915633 439.227667493796;570.821339950372 451.886476426799;582.147642679901 437.895161290323;581.481389578164 423.903846153846;594.806451612903 423.903846153846;594.806451612903 412.577543424318;607.465260545906 412.577543424318;607.465260545906 401.251240694789;617.45905707196 401.251240694789;617.45905707196 389.92493796526;666.761786600496 389.92493796526;666.761786600496 379.264888337469;680.753101736973 379.264888337469;680.753101736973 354.613523573201;692.745657568238 342.620967741935;678.754342431762 330.62841191067;667.428039702233 330.62841191067;667.428039702233 319.302109181141;656.101736972705 319.302109181141;656.101736972705 295.983250620347;646.10794044665 295.983250620347;646.10794044665 270.665632754342;632.782878411911 270.665632754342;632.782878411911 207.37158808933;619.457816377171 194.712779156327;608.131513647643 209.370347394541;582.147642679901 209.370347394541;582.147642679901 158.735111662531;571.487593052109 171.393920595533;558.828784119107 171.393920595533;558.828784119107 158.068858560794;544.83746898263 158.068858560794;544.83746898263 132.084987593052;533.511166253102 132.084987593052;533.511166253102 121.42493796526;482.875930521092 121.42493796526;482.875930521092 85.447270471464;434.239454094293 85.447270471464;434.239454094293 110.098635235732;420.914392059553 110.098635235732;421.58064516129 134.75;408.921836228288 134.75;408.921836228288 158.068858560794];
slater_real = [1415.5 1303.5;1409.5 1273.5;1479.5 1241.5;1513.5 1275.5;1543.5 1243.5;1547.5 1207.5;1587.5 1217.5;1619.5 1155.5;1565.5 1147.5;1535.5 1111.5;1543.5 1071.5;1475.5 991.5;1437.5 923.5;1415.5 691.5;1383.5 665.5;1365.5 535.5;1379.5 461.5;1363.5 393.5;1337.5 373.5;1309.5 443.5;1261.5 419.5;1263.5 359.5;1207.5 321.5;1161.5 329.5;1169.5 357.5;1153.5 391.5;1085.5 365.5;1033.5 377.5;1031.5 279.5;1017.5 237.5;967.5 243.5;931.5 267.5;883.5 307.5;907.5 383.5;897.5 421.5;915.5 471.5;893.5 503.5;927.5 565.5;953.5 601.5;991.5 649.5;985.5 699.5;1027.5 769.5;1049.5 827.5;1071.5 889.5;1141.5 933.5;1149.5 975.5;1045.5 1033.5;1147.5 1083.5;1169.5 1123.5;1111.5 1183.5;1113.5 1271.5;1155.5 1287.5;1191.5 1363.5;1169.5 1407.5;1211.5 1447.5;1251.5 1467.5;1283.5 1407.5;1329.5 1395.5;1337.5 1371.5;1377.5 1355.5];
figure;
Analyze(slater_sim, slater_real, 57, 5, 46);
title('Slater Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(5, '--b');
xline(46, '--b');

%% Devil
figure;
devil_sim = [539.052109181142 369.225186104218;552.327543424318 357.941066997518;552.327543424318 347.984491315136;566.930521091811 347.984491315136;586.179900744417 333.381513647643;586.179900744417 306.83064516129;600.119106699752 293.555210918114;600.119106699752 272.978287841191;612.730769230769 272.978287841191;618.704714640199 280.279776674938;626.006203473945 272.978287841191;626.006203473945 266.340570719603;619.368486352357 259.702853598015;632.643920595534 246.427419354839;632.643920595534 232.488213399504;618.04094292804 219.212779156327;578.87841191067 219.212779156327;558.301488833747 239.78970223325;552.991315136476 239.78970223325;552.991315136476 225.186724565757;532.414392059553 212.575062034739;505.199751861042 212.575062034739;491.260545905707 232.488213399504;491.260545905707 260.366625310174;484.622828784119 260.366625310174;477.321339950372 267.66811414392;477.985111662531 287.581265508685;484.622828784119 306.83064516129;497.234491315136 322.097394540943;497.898263027295 334.70905707196;491.260545905707 334.70905707196;491.260545905707 342.674317617866;498.562034739454 350.639578163772;519.138957816377 349.975806451613;518.475186104218 363.915012406948;525.112903225806 369.225186104218];
devil_real = [1774.49524375743 961.930439952437;1774.49524375743 940.192033293698;1800.18608799049 940.192033293698;1819.94827586207 954.025564803805;1849.59155766944 971.811533888228;1859.47265160523 954.025564803805;1863.42508917955 973.787752675386;1879.23483947681 965.882877526754;1881.21105826397 942.168252080856;1898.9970273484 934.263376932223;1902.94946492271 912.524970273484;1900.97324613555 894.739001189061;1908.87812128419 878.929250891795;1881.21105826397 886.834126040428;1857.49643281807 898.691438763377;1849.59155766944 869.048156956005;1831.80558858502 876.953032104637;1819.94827586207 869.048156956005;1829.82936979786 855.214625445898;1845.63912009513 841.381093935791;1833.78180737218 833.476218787158;1839.71046373365 815.690249702735;1814.01961950059 803.832936979786;1782.40011890606 797.904280618311;1770.54280618312 817.666468489893;1768.56658739596 833.476218787158;1744.85196195006 839.404875148633;1740.89952437574 861.143281807372;1750.78061831153 876.953032104637;1762.63793103448 886.834126040428;1744.85196195006 896.715219976219;1734.97086801427 920.429845422116;1752.75683709869 924.382282996433;1766.5903686088 916.4774078478;1760.66171224732 938.21581450654;1760.66171224732 954.025564803805];
Analyze(devil_sim, devil_real, 33, 7, 32);
title('Devil Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(7, '--b');
xline(32, '--b');

%% Loyalton
loyalton_sim = [270.199751861042 407.155086848635;296.800248138958 407.155086848635;296.800248138958 436.415632754342;326.060794044665 436.415632754342;352.661290322581 467.006203473945;381.921836228288 436.415632754342;408.522332506203 436.415632754342;408.522332506203 469.001240694789;465.048387096774 469.001240694789;465.048387096774 439.740694789082;494.973945409429 439.740694789082;494.973945409429 409.150124069479;524.234491315136 409.150124069479;524.234491315136 380.55459057072;581.425558312655 380.55459057072;581.425558312655 351.95905707196;610.021091811414 351.95905707196;610.021091811414 322.698511166253;667.877171215881 322.698511166253;698.467741935484 295.43300248139;667.877171215881 267.502481389578;667.877171215881 180.385856079404;696.47270471464 150.460297766749;667.212158808933 125.18982630273;667.212158808933 93.2692307692308;638.616625310174 122.529776674938;610.021091811414 122.529776674938;610.021091811414 93.2692307692308;581.425558312655 93.2692307692308;581.425558312655 63.3436724565757;494.308933002481 63.3436724565757;494.308933002481 93.9342431761787;409.187344913151 93.9342431761787;409.187344913151 180.385856079404;353.991315136476 180.385856079404;353.991315136476 209.646401985112;328.055831265509 209.646401985112;328.055831265509 238.241935483871;299.460297766749 238.241935483871;299.460297766749 267.502481389578;268.869727047146 294.767990074442;294.805210918114 322.033498759305;294.805210918114 351.294044665012;270.86476426799 351.294044665012;242.269230769231 378.559553349876];
loyalton_real = [1341.23462002413 1070.01266586248;1356.47708082027 1122.51447527141;1398.81724969843 1159.7738238842;1505.51447527141 1139.45054282268;1488.57840772014 1078.48069963812;1464.86791314837 1044.60856453558;1441.1574185766 959.928226779252;1397.12364294331 919.281664656212;1359.86429433052 927.749698431845;1305.66887816647 885.409529553679;1319.21773220748 802.422798552473;1395.43003618818 734.678528347406;1388.65560916767 697.41917973462;1441.1574185766 590.72195416164;1364.9451145959 556.849819059107;1442.85102533172 489.105548854041;1329.37937273824 439.990952955368;1393.73642943305 409.506031363088;1398.81724969843 336.680940892642;1349.70265379976 287.566344993968;1105.82328106152 280.791917973462;1043.15983112183 321.438480096502;1038.07901085645 345.148974668275;1092.27442702051 397.650784077201;1077.03196622437 419.667671893848;897.509650180941 502.654402895054;856.863088057901 499.267189384801;843.314234016888 534.832931242461;855.169481302774 560.237032569361;819.603739445114 563.624246079614;804.361278648974 589.028347406514;775.569963811821 592.415560916767;800.974065138721 677.0958986731;855.169481302774 709.274427020506;855.169481302774 766.857056694813;875.492762364294 802.422798552473;902.590470446321 809.197225572979;795.893244873341 898.958383594692;841.620627261761 907.426417370326;895.816043425814 910.813630880579;934.768998793727 949.766586248492;1188.81001206273 1020.89806996381;1226.06936067551 1002.26839565742;1310.74969843185 1005.65560916767;1305.66887816647 1031.05971049457];
figure;
Analyze(loyalton_sim, loyalton_real, 42, 5, 40);
title('Loyalton Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(5, '--b');
xline(40, '--b');

%% Monarch
monarch_sim = [400 272;454 272;454 307;470 307;470 324;506 324;506 344;523 344;522 359;575 360;575 342;611 342;611 324;629 324;629 307;649 307;649 271;628 271;628 252;592 252;592 234;574 234;574 200;557 200;557 182;539 165;521 184;521 202;502 202;502 221;486 221;486 237;436 237;436 219;418 219;418 255;400 255];
monarch_real = [2558.5 2022.5;2666.5 2014.5;2826.5 2050.5;2926.5 2034.5;2990.5 1998.5;2942.5 1910.5;2990.5 1854.5;3134.5 1862.5;3110.5 1798.5;3106.5 1682.5;3066.5 1634.5;2970.5 1586.5;2954.5 1542.5;2886.5 1522.5;2882.5 1478.5;2786.5 1446.5;2790.5 1406.5;2890.5 1406.5;2990.5 1338.5;2966.5 1310.5;2894.5 1310.5;2794.5 1338.5;2730.5 1314.5;2706.5 1242.5;2622.5 1218.5;2530.5 1238.5;2490.5 1310.5;2358.5 1402.5;2190.5 1442.5;1990.5 1418.5;1950.5 1462.5;1982.5 1514.5;2042.5 1546.5;2054.5 1618.5;2306.5 1750.5;2334.5 1834.5;2518.5 1942.5];
figure;
Analyze(monarch_sim, monarch_real, 34, 5, 26);
title('Monarch Fire');
xlabel('Vertices');
ylabel('Dissimilarity');
xline(5, '--b');
xline(26, '--b');




function Analyze(sim_polygon, real_polygon, to_remove, min_thresh, max_thresh)
    max_vertices = length(sim_polygon);
    diff = zeros(1, to_remove);
    for v = 1:to_remove
        tf_sim = CreateTurningFunction(sim_polygon);
        tf_real = CreateTurningFunction(real_polygon);
        diff(v) = TfDistance(tf_sim, tf_real);

        % Find the least important vertex in sim
        weights = zeros(1, length(sim_polygon));
        avg_theta = zeros(1, length(sim_polygon));
        avg_dist = zeros(1, length(sim_polygon));
        
        for i = 1:length(sim_polygon)
            x = sim_polygon(i, 1);
            y = sim_polygon(i, 2);

            left_index = i - 1;
            if (left_index == 0)
                left_index = length(sim_polygon);
            end

            right_index = i + 1;
            if (right_index == length(sim_polygon) + 1)
                right_index = 1;
            end

            x_left = sim_polygon(left_index, 1);
            y_left = sim_polygon(left_index, 2);
            x_right = sim_polygon(right_index, 1);
            y_right = sim_polygon(right_index, 2);

            avg_theta(i) = (Theta(x_left, y_left, x, y) + Theta(x_right, y_right, x, y)) / 2;
            avg_dist(i) = (Distance(x_left, y_left, x, y) + Distance(x_right, y_right, x, y)) / 2;
        end
        
        [max_angle, idx] = max(avg_theta);
        [min_angle, idx] = min(avg_theta);
        [max_dist, idx] = max(avg_dist);
        [min_dist, idx] = min(avg_dist);
        
        for i=1:length(weights)
            theta = (avg_theta(i) - min_angle) / (max_angle - min_angle);
            dist = (avg_dist(i) - min_dist) / (max_dist - min_dist);
            weights(i) = theta + (2 * dist);
        end

        [val, idx] = min(weights);
        sim_polygon(idx, :) = [];

        % Find the least important vertex in real
        weights = zeros(1, length(real_polygon));
        avg_theta = zeros(1, length(real_polygon));
        avg_dist = zeros(1, length(real_polygon));
        for i = 1:length(real_polygon)
            x = real_polygon(i, 1);
            y = real_polygon(i, 2);

            left_index = i - 1;
            if (left_index == 0)
                left_index = length(real_polygon);
            end

            right_index = i + 1;
            if (right_index == length(real_polygon) + 1)
                right_index = 1;
            end

            x_left = real_polygon(left_index, 1);
            y_left = real_polygon(left_index, 2);
            x_right = real_polygon(right_index, 1);
            y_right = real_polygon(right_index, 2);

            avg_theta(i) = (Theta(x_left, y_left, x, y) + Theta(x_right, y_right, x, y)) / 2;
            avg_dist(i) = (Distance(x_left, y_left, x, y) + Distance(x_right, y_right, x, y)) / 2;
        end

        [max_angle, idx] = max(avg_theta);
        [min_angle, idx] = min(avg_theta);
        [max_dist, idx] = max(avg_dist);
        [min_dist, idx] = min(avg_dist);
        
        for i=1:length(weights)
            theta = (avg_theta(i) - min_angle) / (max_angle - min_angle);
            dist = (avg_dist(i) - min_dist) / (max_dist - min_dist);
            weights(i) = theta + (2 * dist);
        end
        
        [val, idx] = min(weights);
        real_polygon(idx, :) = [];

    end
    
    x_axis = zeros(1, to_remove);
    for i = 1:length(x_axis)
        x_axis(i) = max_vertices - i + 1;
    end
    
    diff = smooth(diff, 0.3);
    plot(x_axis, diff);
    
    min_index = find(x_axis==min_thresh);
    max_index = find(x_axis==max_thresh);
    values = diff(max_index:min_index);
    mean = sum(values) / length(values);
    yline(mean, '--r');
end


function weight = VertexWeight(v1x, v1y, v2x, v2y, vx, vy)
    theta1 = Theta(v1x, v1y, vx, vy);
    theta2 = Theta(v2x, v2y, vx, vy);
    d1 = pdist([v1x v1y; vx vy], 'euclidean');
    d2 = pdist([v2x v2y; vx vy], 'euclidean');
    
    avg_theta = (theta1 + theta2) / 2;
    avg_dist = (d1 + d2) / 2;
    weight = avg_theta + avg_dist;
end

function theta = Theta(v1x, v1y, v2x, v2y)
    o1 = abs(v1y - v2y);
    a1 = abs(v1x - v2x);
    theta = rad2deg(atan(o1 / a1));
end

function dist = Distance(v1x, v1y, v2x, v2y)
    dist = pdist([v1x v1y; v2x v2y], 'euclidean');
end
